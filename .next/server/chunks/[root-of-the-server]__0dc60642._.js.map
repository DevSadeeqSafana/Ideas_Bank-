{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/ideas_bank/src/lib/db.js"],"sourcesContent":["import mysql from 'mysql2/promise';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst pool = mysql.createPool({\n  host: process.env.DB_HOST || '127.0.0.1',\n  user: process.env.DB_USER || 'exam_user',\n  password: process.env.DB_PASSWORD || 'exam_password',\n  port: parseInt(process.env.DB_PORT, 10) || 3307,\n  database: process.env.DB_NAME || 'ideas_bank',\n  waitForConnections: true,\n  connectionLimit: 10,\n  queueLimit: 0\n});\n\n(async () => {\n  try {\n    const connection = await pool.getConnection();\n    console.log(`✅ Connected to ${process.env.DB_NAME || 'ideas_bank'} database`);\n    connection.release();\n  } catch (err) {\n    console.error('❌ Database connection failed:', err.message);\n  }\n})();\n\nexport default pool;\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEA,uIAAA,CAAA,UAAM,CAAC,MAAM;AAEb,MAAM,OAAO,mIAAA,CAAA,UAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,MAAM,SAAS,QAAQ,GAAG,CAAC,OAAO,EAAE,OAAO;IAC3C,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AACd;AAEA,CAAC;IACC,IAAI;QACF,MAAM,aAAa,MAAM,KAAK,aAAa;QAC3C,QAAQ,GAAG,CAAC,CAAC,eAAe,EAAE,QAAQ,GAAG,CAAC,OAAO,IAAI,aAAa,SAAS,CAAC;QAC5E,WAAW,OAAO;IACpB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,iCAAiC,IAAI,OAAO;IAC5D;AACF,CAAC;uCAEc","debugId":null}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/ideas_bank/src/lib/cryptoUtil.js"],"sourcesContent":["\nexport function encrypt(text) {\n  return Buffer.from(String(text).toString(), 'utf8').toString('base64');\n}\n\nexport function decrypt(encodedText) {\n  return Buffer.from(encodedText, 'base64').toString('utf8');\n}"],"names":[],"mappings":";;;;AACO,SAAS,QAAQ,IAAI;IAC1B,OAAO,OAAO,IAAI,CAAC,OAAO,MAAM,QAAQ,IAAI,QAAQ,QAAQ,CAAC;AAC/D;AAEO,SAAS,QAAQ,WAAW;IACjC,OAAO,OAAO,IAAI,CAAC,aAAa,UAAU,QAAQ,CAAC;AACrD","debugId":null}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/ideas_bank/src/lib/traineeUtils.js"],"sourcesContent":["import { decrypt } from './cryptoUtil';\n\n/**\n * Standardized utility functions for trainee ID handling\n * Addresses inconsistent field mapping across the application\n */\n\n/**\n * Extract trainee ID from various possible field names\n * @param {Object} data - Object that might contain trainee ID in various field names\n * @returns {string|number|null} - Trainee ID or null if not found\n */\nexport function extractTraineeId(data) {\n  if (!data || typeof data !== 'object') {\n    return null;\n  }\n\n  // Try different possible field names in order of preference\n  const possibleFields = [\n    'traineeId',  // Our standardized field name\n    'id',         // Most common\n    'ID',         // Sometimes uppercase\n    'SN',         // Serial Number from database\n    'sn',         // Lowercase version\n    'trainee_sn', // Alternative database field\n    'trainee_id', // Alternative field name\n  ];\n\n  for (const field of possibleFields) {\n    if (data[field] != null && data[field] !== '') {\n      return data[field];\n    }\n  }\n\n  return null;\n}\n\n/**\n * Get trainee ID from URL search params with decryption support\n * @param {URLSearchParams} searchParams - URL search parameters\n * @param {string} paramName - Parameter name to look for (default: 'traineeId')\n * @param {boolean} encrypted - Whether the ID is encrypted (default: false)\n * @returns {string|null} - Trainee ID or null if not found\n */\nexport function getTraineeIdFromParams(searchParams, paramName = 'traineeId', encrypted = false) {\n  if (!searchParams) return null;\n\n  // Try different parameter names\n  const possibleParams = [paramName, 'id', 'traineeId'];\n  \n  for (const param of possibleParams) {\n    const value = searchParams.get(param);\n    if (value) {\n      try {\n        return encrypted ? decrypt(value) : value;\n      } catch (error) {\n        console.error(`Error decrypting trainee ID from param ${param}:`, error);\n        // If decryption fails, try returning the raw value\n        return value;\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Get trainee ID from localStorage with fallback options\n * @returns {string|null} - Trainee ID or null if not found\n */\nexport function getTraineeIdFromStorage() {\n  if (typeof window === 'undefined') return null;\n\n  try {\n    // First try the dedicated traineeId storage\n    const directId = localStorage.getItem('traineeId');\n    if (directId) return directId;\n\n    // Fallback to extracting from stored data\n    const storedData = localStorage.getItem('data');\n    if (storedData) {\n      const parsed = JSON.parse(storedData);\n      return extractTraineeId(parsed);\n    }\n  } catch (error) {\n    console.error('Error reading trainee ID from localStorage:', error);\n  }\n\n  return null;\n}\n\n/**\n * Store trainee ID in localStorage with standardized key\n * @param {string|number} traineeId - Trainee ID to store\n * @param {Object} additionalData - Additional data to store alongside ID\n */\nexport function storeTraineeId(traineeId, additionalData = null) {\n  if (typeof window === 'undefined') return;\n\n  try {\n    if (traineeId != null && traineeId !== '') {\n      localStorage.setItem('traineeId', String(traineeId));\n      \n      if (additionalData) {\n        const existingData = localStorage.getItem('data');\n        const dataToStore = existingData ? \n          { ...JSON.parse(existingData), ...additionalData, traineeId } :\n          { ...additionalData, traineeId };\n        \n        localStorage.setItem('data', JSON.stringify(dataToStore));\n      }\n    }\n  } catch (error) {\n    console.error('Error storing trainee ID:', error);\n  }\n}\n\n/**\n * Validate trainee ID format\n * @param {any} traineeId - ID to validate\n * @returns {boolean} - Whether the ID is valid\n */\nexport function isValidTraineeId(traineeId) {\n  if (traineeId == null || traineeId === '') {\n    return false;\n  }\n\n  const stringId = String(traineeId).trim();\n  \n  // Check if it's a valid number or non-empty string\n  return stringId.length > 0 && !isNaN(Number(stringId));\n}\n\n/**\n * Normalize trainee ID to a consistent format\n * @param {any} traineeId - ID to normalize\n * @returns {number|null} - Normalized ID as number or null if invalid\n */\nexport function normalizeTraineeId(traineeId) {\n  if (!isValidTraineeId(traineeId)) {\n    return null;\n  }\n\n  const numericId = Number(traineeId);\n  return isNaN(numericId) ? null : numericId;\n}\n\n/**\n * Build trainee data object with consistent field mapping\n * @param {Object} rawData - Raw data from API or storage\n * @returns {Object} - Normalized trainee data\n */\nexport function normalizeTraineeData(rawData) {\n  if (!rawData || typeof rawData !== 'object') {\n    return {};\n  }\n\n  const traineeId = extractTraineeId(rawData);\n  \n  return {\n    ...rawData,\n    traineeId: normalizeTraineeId(traineeId),\n    // Ensure consistent field names\n    fullname: rawData.fullname || rawData.FullName || rawData.full_name,\n    registrationno: rawData.registrationno || rawData.registrationNo || rawData.registration_no,\n  };\n}"],"names":[],"mappings":";;;;;;;;;AAAA;;AAYO,SAAS,iBAAiB,IAAI;IACnC,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;QACrC,OAAO;IACT;IAEA,4DAA4D;IAC5D,MAAM,iBAAiB;QACrB;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,KAAK,MAAM,SAAS,eAAgB;QAClC,IAAI,IAAI,CAAC,MAAM,IAAI,QAAQ,IAAI,CAAC,MAAM,KAAK,IAAI;YAC7C,OAAO,IAAI,CAAC,MAAM;QACpB;IACF;IAEA,OAAO;AACT;AASO,SAAS,uBAAuB,YAAY,EAAE,YAAY,WAAW,EAAE,YAAY,KAAK;IAC7F,IAAI,CAAC,cAAc,OAAO;IAE1B,gCAAgC;IAChC,MAAM,iBAAiB;QAAC;QAAW;QAAM;KAAY;IAErD,KAAK,MAAM,SAAS,eAAgB;QAClC,MAAM,QAAQ,aAAa,GAAG,CAAC;QAC/B,IAAI,OAAO;YACT,IAAI;gBACF,OAAO,YAAY,CAAA,GAAA,0HAAA,CAAA,UAAO,AAAD,EAAE,SAAS;YACtC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,CAAC,uCAAuC,EAAE,MAAM,CAAC,CAAC,EAAE;gBAClE,mDAAmD;gBACnD,OAAO;YACT;QACF;IACF;IAEA,OAAO;AACT;AAMO,SAAS;IACd,wCAAmC,OAAO;;;AAkB5C;AAOO,SAAS,eAAe,SAAS,EAAE,iBAAiB,IAAI;IAC7D,wCAAmC;;;AAkBrC;AAOO,SAAS,iBAAiB,SAAS;IACxC,IAAI,aAAa,QAAQ,cAAc,IAAI;QACzC,OAAO;IACT;IAEA,MAAM,WAAW,OAAO,WAAW,IAAI;IAEvC,mDAAmD;IACnD,OAAO,SAAS,MAAM,GAAG,KAAK,CAAC,MAAM,OAAO;AAC9C;AAOO,SAAS,mBAAmB,SAAS;IAC1C,IAAI,CAAC,iBAAiB,YAAY;QAChC,OAAO;IACT;IAEA,MAAM,YAAY,OAAO;IACzB,OAAO,MAAM,aAAa,OAAO;AACnC;AAOO,SAAS,qBAAqB,OAAO;IAC1C,IAAI,CAAC,WAAW,OAAO,YAAY,UAAU;QAC3C,OAAO,CAAC;IACV;IAEA,MAAM,YAAY,iBAAiB;IAEnC,OAAO;QACL,GAAG,OAAO;QACV,WAAW,mBAAmB;QAC9B,gCAAgC;QAChC,UAAU,QAAQ,QAAQ,IAAI,QAAQ,QAAQ,IAAI,QAAQ,SAAS;QACnE,gBAAgB,QAAQ,cAAc,IAAI,QAAQ,cAAc,IAAI,QAAQ,eAAe;IAC7F;AACF","debugId":null}},
    {"offset": {"line": 328, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/ideas_bank/src/app/api/trainee/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport pool from '@/lib/db';\r\nimport { normalizeTraineeId, isValidTraineeId } from '@/lib/traineeUtils';\r\n\r\nexport async function POST(request, { params }) {\r\n  try {\r\n    const data = await request.json();\r\n\r\n    // Validate and normalize trainee ID\r\n    const traineeId = normalizeTraineeId(data.traineeId);\r\n    if (!isValidTraineeId(traineeId)) {\r\n      return NextResponse.json(\r\n        { error: 'Valid trainee ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const connection = await pool.getConnection();\r\n    \r\n    try {\r\n      await connection.beginTransaction();\r\n      console.log(`UPDATE trainees SET \r\n        bank_name = ?, account_number = ?, account_name = ?, bvn = ?\r\n        WHERE id = ?`,\r\n        [\r\n          data.bank_name, data.account_number, data.account_name, data.bvn,\r\n          traineeId\r\n        ])\r\n      // Update bank info\r\n      await connection.query(\r\n        `UPDATE trainees SET \r\n        bank_name = ?, account_number = ?, account_name = ?, bvn = ?\r\n        WHERE id = ?`,\r\n        [\r\n          data.bank_name, data.account_number, data.account_name, data.bvn,\r\n          traineeId\r\n        ]\r\n      );\r\n\r\n     \r\n      await connection.commit();\r\n\r\n      return NextResponse.json(\r\n        { \r\n          message: 'Trainee bank information updated successfully',\r\n          traineeId: traineeId \r\n        },\r\n        { status: 200 }\r\n      );\r\n\r\n    } catch (error) {\r\n      await connection.rollback();\r\n      throw error;\r\n    } finally {\r\n      connection.release();\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('Update trainee error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Internal server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function PUT(request, { params }) {\r\n  try {\r\n    const data = await request.json();\r\n\r\n    // Validate and normalize trainee ID\r\n    const traineeId = normalizeTraineeId(data.id);\r\n    if (!isValidTraineeId(traineeId)) {\r\n      return NextResponse.json(\r\n        { error: 'Valid trainee ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const connection = await pool.getConnection();\r\n    \r\n    try {\r\n      await connection.beginTransaction();\r\n\r\n      // Update trainee verification information\r\n      await connection.query(\r\n        `UPDATE trainees SET \r\n        nin = ?, date_of_birth = ?\r\n        WHERE id = ?`,\r\n        [\r\n          data.nin, data.date_of_birth,\r\n          traineeId\r\n        ]\r\n      );\r\n\r\n      await connection.commit();\r\n\r\n      return NextResponse.json(\r\n        { \r\n          message: 'Trainee verification information updated successfully',\r\n          traineeId: traineeId \r\n        },\r\n        { status: 200 }\r\n      );\r\n\r\n    } catch (error) {\r\n      await connection.rollback();\r\n      throw error;\r\n    } finally {\r\n      connection.release();\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('Update trainee error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Internal server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAO,EAAE,EAAE,MAAM,EAAE;IAC5C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,oCAAoC;QACpC,MAAM,YAAY,CAAA,GAAA,4HAAA,CAAA,qBAAkB,AAAD,EAAE,KAAK,SAAS;QACnD,IAAI,CAAC,CAAA,GAAA,4HAAA,CAAA,mBAAgB,AAAD,EAAE,YAAY;YAChC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA+B,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,aAAa,MAAM,kHAAA,CAAA,UAAI,CAAC,aAAa;QAE3C,IAAI;YACF,MAAM,WAAW,gBAAgB;YACjC,QAAQ,GAAG,CAAC,CAAC;;oBAEC,CAAC,EACb;gBACE,KAAK,SAAS;gBAAE,KAAK,cAAc;gBAAE,KAAK,YAAY;gBAAE,KAAK,GAAG;gBAChE;aACD;YACH,mBAAmB;YACnB,MAAM,WAAW,KAAK,CACpB,CAAC;;oBAEW,CAAC,EACb;gBACE,KAAK,SAAS;gBAAE,KAAK,cAAc;gBAAE,KAAK,YAAY;gBAAE,KAAK,GAAG;gBAChE;aACD;YAIH,MAAM,WAAW,MAAM;YAEvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,SAAS;gBACT,WAAW;YACb,GACA;gBAAE,QAAQ;YAAI;QAGlB,EAAE,OAAO,OAAO;YACd,MAAM,WAAW,QAAQ;YACzB,MAAM;QACR,SAAU;YACR,WAAW,OAAO;QACpB;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,IAAI,OAAO,EAAE,EAAE,MAAM,EAAE;IAC3C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,oCAAoC;QACpC,MAAM,YAAY,CAAA,GAAA,4HAAA,CAAA,qBAAkB,AAAD,EAAE,KAAK,EAAE;QAC5C,IAAI,CAAC,CAAA,GAAA,4HAAA,CAAA,mBAAgB,AAAD,EAAE,YAAY;YAChC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA+B,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,aAAa,MAAM,kHAAA,CAAA,UAAI,CAAC,aAAa;QAE3C,IAAI;YACF,MAAM,WAAW,gBAAgB;YAEjC,0CAA0C;YAC1C,MAAM,WAAW,KAAK,CACpB,CAAC;;oBAEW,CAAC,EACb;gBACE,KAAK,GAAG;gBAAE,KAAK,aAAa;gBAC5B;aACD;YAGH,MAAM,WAAW,MAAM;YAEvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,SAAS;gBACT,WAAW;YACb,GACA;gBAAE,QAAQ;YAAI;QAGlB,EAAE,OAAO,OAAO;YACd,MAAM,WAAW,QAAQ;YACzB,MAAM;QACR,SAAU;YACR,WAAW,OAAO;QACpB;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}